/*
AUTOR: DAVID RODRIGUEZ RIVERA
FECHA: 21/02/2021
DESC: CREACIÓN DE LA TABLA INV_INVENTARIO
CAMPOS: 
ESQUEMA: DB_FABRICA
REF_CODIGO: CODIGO DE LA REFERENCIA (FK)
TALLA_CODIGO: CODIGO DE LA TALLA (FK)
COLOR_CODIGO: CODIGO DEL COLOR (FK)
CANTIDAD: CANTIDAD DE UNIDADES DISPONIBLES 
*/

DECLARE
VALOR NUMBER;
BEGIN 
  SELECT COUNT (*) INTO VALOR FROM ALL_TABLES WHERE TABLE_NAME = 'INV_INVENTARIO' AND OWNER = 'DB_FABRICA';
  IF (VALOR = 0) THEN 
  EXECUTE IMMEDIATE '
    CREATE TABLE "DB_FABRICA"."INV_INVENTARIO"
    (
        INVENTARIO_CODIGO number not null,
        REF_CODIGO NUMERIC NOT NULL,
        TALLA_CODIGO NUMBER NOT NULL,
        COLOR_CODIGO NUMBER NOT NULL,
        CANTIDAD NUMBER,
        created_at TIMESTAMP,
        update_at TIMESTAMP,
        
        FOREIGN KEY (REF_CODIGO) REFERENCES DB_FABRICA.INV_REFERENCIAS(REF_CODIGO),
        FOREIGN KEY (TALLA_CODIGO) REFERENCES DB_FABRICA.INV_TALLAS(TALLA_CODIGO),
        FOREIGN KEY (COLOR_CODIGO) REFERENCES DB_FABRICA.INV_COLORES(COLOR_CODIGO)        
    )';
  
  END IF;

END;

 
/
